---
title: Dockeré•œåƒç®¡ç†
description: é•œåƒç®¡ç†
author: solutide
page: true
date: 2025-07-30
category: Docker
tag:
  - Docker
  - é•œåƒ
  - å®¹å™¨
---
## é•œåƒç®¡ç†

Docker é•œåƒæ˜¯å®¹å™¨è¿è¡Œçš„åŸºç¡€ï¼Œå®ƒæ˜¯ä¸€ä¸ªåªè¯»çš„æ¨¡æ¿ï¼ŒåŒ…å«äº†è¿è¡Œåº”ç”¨ç¨‹åºæ‰€éœ€çš„ä»£ç ã€åº“ã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ã€‚è‰¯å¥½çš„é•œåƒç®¡ç†æ˜¯é«˜æ•ˆä½¿ç”¨ Docker çš„å…³é”®ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç» Docker é•œåƒçš„å¸¸ç”¨æ“ä½œã€æœ€ä½³å®è·µå’Œä¼˜åŒ–æŠ€å·§ã€‚

## 1. æŸ¥çœ‹æœ¬åœ°é•œåƒ

ä½¿ç”¨ `docker images` æˆ– `docker image ls` å‘½ä»¤æŸ¥çœ‹æœ¬åœ°å·²æœ‰çš„é•œåƒã€‚

```bash
docker images

**# æˆ–**

docker image ls
```

### è¾“å‡ºå­—æ®µè¯´æ˜

|                |                                                           |
| -------------- | --------------------------------------------------------- |
| `REPOSITORY` | é•œåƒçš„ä»“åº“åç§°ï¼ˆå¦‚ `nginx`,`mysql`ï¼‰                  |
| `TAG`        | é•œåƒçš„æ ‡ç­¾ï¼Œé€šå¸¸è¡¨ç¤ºç‰ˆæœ¬ï¼ˆå¦‚ `latest`,`1.21-alpine`ï¼‰ |
| `IMAGE ID`   | é•œåƒçš„å”¯ä¸€ IDï¼ˆå“ˆå¸Œå€¼ï¼‰                                   |
| `CREATED`    | é•œåƒåˆ›å»ºæ—¶é—´                                              |
| `SIZE`       | é•œåƒå¤§å°                                                  |

### å¸¸ç”¨é€‰é¡¹

```bash
# åªæ˜¾ç¤ºé•œåƒ ID
docker images -q

# æ˜¾ç¤ºæ‰€æœ‰é•œåƒï¼ˆåŒ…æ‹¬ä¸­é—´å±‚ï¼‰
docker images -a

# æŒ‰å¤§å°æ’åº
docker images --format "table {{.Repository}}\t{{.Tag}}\t{{.Size}}"
```

---

## ğŸ”½ 2. æ‹‰å–é•œåƒ

ä» Docker Hub æˆ–ç§æœ‰ä»“åº“ä¸‹è½½é•œåƒã€‚

```bash
# æ‹‰å–æœ€æ–°ç‰ˆ nginx
docker pull nginx

# æ‹‰å–æŒ‡å®šç‰ˆæœ¬
docker pull nginx:1.21-alpine

# æ‹‰å–ç§æœ‰ä»“åº“é•œåƒ
docker pull registry.example.com/myapp:v1.0
```

> ğŸ’¡ æç¤ºï¼šä¸æŒ‡å®š `:tag` æ—¶ï¼Œé»˜è®¤æ‹‰å– `latest` æ ‡ç­¾ã€‚

---

## ğŸ—ï¸ 3. æ„å»ºé•œåƒ

ä½¿ç”¨ `Dockerfile` æ„å»ºè‡ªå®šä¹‰é•œåƒã€‚

```bash
docker build -t myapp:v1.0 .
```

### å¸¸ç”¨é€‰é¡¹

|                     |                                                        |
| ------------------- | ------------------------------------------------------ |
| `-t`æˆ– `--tag`  | æŒ‡å®šé•œåƒåç§°å’Œæ ‡ç­¾                                     |
| `-f`æˆ– `--file` | æŒ‡å®š Dockerfile è·¯å¾„ï¼ˆå¦‚ `-f ./Dockerfile.prod`ï¼‰    |
| `--no-cache`      | æ„å»ºæ—¶ä¸ä½¿ç”¨ç¼“å­˜                                       |
| `--build-arg`     | ä¼ é€’æ„å»ºå‚æ•°ï¼ˆå¦‚ `--build-arg NODE_ENV=production`ï¼‰ |

### ç¤ºä¾‹ Dockerfile

```Dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
EXPOSE 3000
CMD ["node", "server.js"]
```

## ğŸš€ 4. è¿è¡Œå®¹å™¨

åŸºäºé•œåƒå¯åŠ¨å®¹å™¨ã€‚

```bash
docker run -d --name my-nginx -p 8080:80 nginx:latest
```

* `-d`ï¼šåå°è¿è¡Œ
* `--name`ï¼šæŒ‡å®šå®¹å™¨åç§°
* `-p`ï¼šç«¯å£æ˜ å°„
* `-v`ï¼šæŒ‚è½½å·

---

## ğŸ“¤ 5. æ¨é€é•œåƒ

å°†æœ¬åœ°é•œåƒæ¨é€åˆ°é•œåƒä»“åº“ï¼ˆå¦‚ Docker Hubã€é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ï¼‰ã€‚

```
# 1. ç™»å½•ä»“åº“
docker login

# 2. æ ‡è®°é•œåƒï¼ˆtagï¼‰
docker tag myapp:v1.0 username/myapp:v1.0

# 3. æ¨é€
docker push username/myapp:v1.0
```

---

## ğŸ—‘ï¸ 6. åˆ é™¤é•œåƒ

```
# åˆ é™¤æŒ‡å®šé•œåƒ
docker rmi myapp:v1.0

# å¼ºåˆ¶åˆ é™¤ï¼ˆå³ä½¿è¢«å®¹å™¨ä½¿ç”¨ï¼‰
docker rmi -f IMAGE_ID

# åˆ é™¤æ‰€æœ‰æœªè¢«ä½¿ç”¨çš„é•œåƒï¼ˆæ¸…ç†ç©ºé—´ï¼‰
docker image prune
docker image prune -a  # åˆ é™¤æ‰€æœ‰æœªè¢«å¼•ç”¨çš„é•œåƒ
```

> âš ï¸ æ³¨æ„ï¼šæ­£åœ¨è¢«å®¹å™¨ä½¿ç”¨çš„é•œåƒæ— æ³•åˆ é™¤ï¼Œéœ€å…ˆ `docker rm` å®¹å™¨ã€‚

---

## ğŸ” 7. æŸ¥çœ‹é•œåƒè¯¦æƒ…

```
docker inspect IMAGE_ID
```

è¾“å‡º JSON æ ¼å¼ï¼ŒåŒ…å«é•œåƒçš„æ„å»ºä¿¡æ¯ã€ç¯å¢ƒå˜é‡ã€CMDã€ç½‘ç»œé…ç½®ç­‰ã€‚

---

## ğŸ§¼ 8. é•œåƒä¼˜åŒ–æœ€ä½³å®è·µ

### âœ… ä½¿ç”¨å°åŸºç¡€é•œåƒ

ä¼˜å…ˆä½¿ç”¨ `alpine`ã€`slim` ç­‰è½»é‡é•œåƒï¼š

```
FROM node:18-alpine  # è€Œä¸æ˜¯ node:18
```

### âœ… åˆå¹¶ RUN æŒ‡ä»¤

å‡å°‘é•œåƒå±‚æ•°ï¼š

```
# å¥½çš„åšæ³•
RUN apt-get update && \
    apt-get install -y curl && \
    rm -rf /var/lib/apt/lists/*
```

### âœ… ä½¿ç”¨ .dockerignore

é¿å…å°†ä¸å¿…è¦çš„æ–‡ä»¶ï¼ˆå¦‚ `node_modules`, `.git`ï¼‰æ‰“åŒ…è¿›é•œåƒï¼š

```
node_modules
.git
README.md
*.log
```

### âœ… å¤šé˜¶æ®µæ„å»ºï¼ˆMulti-stage Buildï¼‰

é€‚ç”¨äºç¼–è¯‘å‹è¯­è¨€ï¼ˆå¦‚ Goã€Javaã€Node.jsï¼‰ï¼š

```
# æ„å»ºé˜¶æ®µ
FROM node:18 AS builder
WORKDIR /app
COPY . .
RUN npm run build

# è¿è¡Œé˜¶æ®µ
FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
```

## ğŸ”„ 9. é•œåƒåŒæ­¥ä¸å¤‡ä»½

### ä¿å­˜é•œåƒä¸º tar æ–‡ä»¶

```
docker save -o myapp.tar myapp:v1.0
```

### ä» tar æ–‡ä»¶åŠ è½½é•œåƒ

```
docker load -i myapp.tar
```

> é€‚ç”¨äºç¦»çº¿ç¯å¢ƒæˆ–è¿ç§»ã€‚

---

## ğŸ“Š æ€»ç»“ï¼šå¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

|          |                                   |
| -------- | --------------------------------- |
| æŸ¥çœ‹é•œåƒ | `docker images`                 |
| æ‹‰å–é•œåƒ | `docker pull nginx`             |
| æ„å»ºé•œåƒ | `docker build -t myapp .`       |
| æ¨é€é•œåƒ | `docker push username/myapp`    |
| åˆ é™¤é•œåƒ | `docker rmi myapp`              |
| ä¿å­˜é•œåƒ | `docker save -o file.tar image` |
| åŠ è½½é•œåƒ | `docker load -i file.tar`       |
